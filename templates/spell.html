<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spell in Wonderland - Listening Practice</title>
    <link rel="stylesheet" href="spellStyles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel&family=IM+Fell+English+SC&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <p>Listen to the word, read the definition, and type what you hear!</p>
    
        <!-- Word details with font hierarchy -->
        <div class="word-details">
            <p id="correct-word" class="correct-word"></p>
            <p class="pronunciation">
                <span onclick="playPronunciation()" class="speaker-icon" style="cursor: pointer;">
                    <!-- Speaker Icon SVG -->
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M5 8.5v7h4l5 5v-17l-5 5H5zm9 1.5a3.5 3.5 0 0 1 0 5m2-7a6.5 6.5 0 0 1 0 9" stroke="currentColor" stroke-width="2" fill="none" />
                    </svg>
                </span>
            </p>
            <p class="part-of-speech"></p>
            <p class="definition"></p>
        </div>
    
        <!-- Form with text box and submit button -->
        <div class="form-container">
            <form onsubmit="handleSubmit(event)" autocomplete="off">
                <input type="text" id="answer" placeholder="Type the word here...">
                <button type="submit" id="submit-btn">Submit</button>
            </form>
        </div>
    </div>
    
    <script>
        let correctAnswer = "";

        window.onload = function() {
            const word = 'license';
            fetchWordData(word);
        };

        function fetchWordData(word) {
            const apiUrl = `https://api.dictionaryapi.dev/api/v2/entries/en/${word}`;
            
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const wordData = data[0];
                    correctAnswer = wordData.word;  // Set correct answer for submission check
                    const phonetic = wordData.phonetic || '';
                    const audioUrl = wordData.phonetics[0]?.audio || '';
                    const partOfSpeech = wordData.meanings[0]?.partOfSpeech || '';
                    const definition = wordData.meanings[0]?.definitions[0]?.definition || '';

                    // Populate HTML elements with fetched data
                    document.getElementById('correct-word').textContent = correctAnswer;
                    document.querySelector('.pronunciation').textContent = phonetic;
                    document.querySelector('.part-of-speech').textContent = partOfSpeech;
                    document.querySelector('.definition').textContent = definition;

                    // Set pronunciation audio if available
                    if (audioUrl) {
                        document.querySelector('.speaker-icon').onclick = function() {
                            const audio = new Audio(audioUrl);
                            audio.play();
                        };
                    }
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        function handleSubmit(event) {
            event.preventDefault();
            const userAnswer = document.getElementById('answer').value.trim();
            const correctWordElement = document.getElementById('correct-word');
            const submitBtn = document.getElementById('submit-btn');

            // Color the input field based on correctness
            if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                document.getElementById('answer').style.color = "green";
            } else {
                document.getElementById('answer').style.color = "red";
            }

            // Show correct answer
            correctWordElement.classList.add("shown");

            // Change button to "Next Word"
            submitBtn.textContent = "Next Word";
            submitBtn.onclick = loadNextWord;
        }

        function loadNextWord() {
            document.getElementById('correct-word').textContent = "";
            document.getElementById('answer').value = "";
            document.getElementById('answer').style.color = "black";
            document.getElementById('submit-btn').textContent = "Submit";
            document.getElementById('submit-btn').onclick = null;

            const nextWord = "example";  // Replace with logic to fetch the next word
            fetchWordData(nextWord);
        }
    </script>
</body>
</html>
